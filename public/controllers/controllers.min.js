karaTubeApp.controller("MainCtrl",["$scope",function(n){n.playlist=[],n.currentSongIndex=-1,n.nextSongIndex=-1,n.shuffle=!1,n.nextSongName="",n.player=null,n.init=function(e){n.player=e},n.addSong2Playlist=function(e){obj={id:e.data("id"),img:getImgFromID(e.data("id")),title:e.data("title"),duration:e.data("duration"),uploader:e.data("uploader"),view:e.data("view")},n.playlist.push(obj),1==n.playlist.length&&(n.playSong(0),n.nextSongIndex=-1),n.updateNextSong()},n.updateNextSong=function(){n.playlist.length<=1?(n.nextSongIndex=-1,n.nextSongName="Please add more songs to your playlist."):(0==n.shuffle&&(n.nextSongIndex=(n.currentSongIndex+1)%n.playlist.length),n.nextSongName=n.playlist[n.nextSongIndex].title),n.$apply()},n.playSong=function(e){0>e||e>=n.playlist.length||(n.player.loadVideoById(n.playlist[e].id),n.player.playVideo(),n.currentSongIndex=e,n.updateNextSong())},n.removeSong=function(e){n.currentSongIndex!=e&&(n.playlist.splice(e,1),n.nextSongIndex>e&&(n.nextSongIndex-=1),n.currentSongIndex>e&&(n.currentSongIndex-=1),n.updateNextSong())},n.playNextSong=function(){return past=n.currentSongIndex,n.playSong(n.nextSongIndex),n.removeSong(past),n.currentSongIndex},getImgFromID=function(n){return"//img.youtube.com/vi/"+n+"/1.jpg"}}]);